game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "HEY HEY!",
    Text = "PLEASE DO NOT MODIFY THIS SCRIPT PLEASE GO TO discord.gg/AIROW,cowy.com IF YOU HAVE WANT YOUR IDEAS TO BE ON THERE",
    Duration = 20
})

-- GUI Setup
local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ESPGui"
screenGui.ResetOnSpawn = false
screenGui.IgnoreGuiInset = true
screenGui.DisplayOrder = 999999
screenGui.Parent = playerGui

local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(0, 120, 0, 40)
toggleButton.Position = UDim2.new(0, 10, 1, -50)
toggleButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
toggleButton.TextColor3 = Color3.new(1, 1, 1)
toggleButton.Text = "Toggle ESP"
toggleButton.ZIndex = 10000
toggleButton.Parent = screenGui

local espEnabled = false

local colorMap = {
	["Head"] = Color3.fromRGB(255, 0, 0),
	["Torso"] = Color3.fromRGB(0, 0, 255),
	["UpperTorso"] = Color3.fromRGB(0, 0, 255),
	["LowerTorso"] = Color3.fromRGB(0, 0, 255),
	["Left Leg"] = Color3.fromRGB(0, 255, 0),
	["Right Leg"] = Color3.fromRGB(0, 255, 0),
	["LeftLowerLeg"] = Color3.fromRGB(0, 255, 0),
	["RightLowerLeg"] = Color3.fromRGB(0, 255, 0),
	["LeftUpperLeg"] = Color3.fromRGB(0, 255, 0),
	["RightUpperLeg"] = Color3.fromRGB(0, 255, 0),
	["Left Arm"] = Color3.fromRGB(128, 0, 128),
	["Right Arm"] = Color3.fromRGB(128, 0, 128),
	["LeftLowerArm"] = Color3.fromRGB(128, 0, 128),
	["RightLowerArm"] = Color3.fromRGB(128, 0, 128),
	["LeftUpperArm"] = Color3.fromRGB(128, 0, 128),
	["RightUpperArm"] = Color3.fromRGB(128, 0, 128)
}

-- Create ESP part adornment
local function addESPPart(part, color)
	if not part:FindFirstChild("ESPAdornment") then
		local adorn = Instance.new("BoxHandleAdornment")
		adorn.Name = "ESPAdornment"
		adorn.Adornee = part
		adorn.Size = part.Size
		adorn.Color3 = color
		adorn.AlwaysOnTop = true
		adorn.ZIndex = 5
		adorn.Transparency = 0.3
		adorn.Parent = part
	end
end

-- Name + Health tag with proper scaling
local function addNameHealthTag(character, playerObj)
	if character:FindFirstChild("Head") and not character:FindFirstChild("ESPBillboard") then
		local billboard = Instance.new("BillboardGui")
		billboard.Name = "ESPBillboard"
		billboard.Size = UDim2.new(4, 0, 1, 0) -- scalable size
		billboard.StudsOffset = Vector3.new(0, 2.5, 0)
		billboard.AlwaysOnTop = true
		billboard.Adornee = character.Head
		billboard.MaxDistance = 150
		billboard.Parent = character

		local nameLabel = Instance.new("TextLabel")
		nameLabel.Size = UDim2.new(1, 0, 0.5, 0)
		nameLabel.BackgroundTransparency = 1
		nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
		nameLabel.TextStrokeTransparency = 0.5
		nameLabel.Font = Enum.Font.SourceSansBold
		nameLabel.TextScaled = true
		nameLabel.Text = playerObj.Name
		nameLabel.Parent = billboard

		local healthLabel = Instance.new("TextLabel")
		healthLabel.Size = UDim2.new(1, 0, 0.5, 0)
		healthLabel.Position = UDim2.new(0, 0, 0.5, 0)
		healthLabel.BackgroundTransparency = 1
		healthLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
		healthLabel.TextStrokeTransparency = 0.5
		healthLabel.Font = Enum.Font.SourceSansBold
		healthLabel.TextScaled = true
		healthLabel.Name = "HealthLabel"
		healthLabel.Text = ""
		healthLabel.Parent = billboard

		local humanoid = character:FindFirstChildOfClass("Humanoid")
		if humanoid then
			coroutine.wrap(function()
				while billboard and billboard.Parent and espEnabled do
					healthLabel.Text = "HP: " .. math.floor(humanoid.Health) .. " / " .. math.floor(humanoid.MaxHealth)
					wait(0.5)
				end
			end)()
		end
	end
end

-- Full ESP setup
local function addESPToCharacter(character, playerObj)
	for _, part in ipairs(character:GetDescendants()) do
		if part:IsA("BasePart") and colorMap[part.Name] then
			addESPPart(part, colorMap[part.Name])
		end
	end
	addNameHealthTag(character, playerObj)
end

-- Remove ESP
local function removeESPFromCharacter(character)
	for _, part in ipairs(character:GetDescendants()) do
		if part:IsA("BasePart") then
			local adorn = part:FindFirstChild("ESPAdornment")
			if adorn then
				adorn:Destroy()
			end
		end
	end
	local tag = character:FindFirstChild("ESPBillboard")
	if tag then
		tag:Destroy()
	end
end

-- Toggle ESP
toggleButton.MouseButton1Click:Connect(function()
	espEnabled = not espEnabled
	toggleButton.Text = espEnabled and "ESP ON" or "ESP OFF"
end)

-- Auto update ESP
task.spawn(function()
	while true do
		task.wait(1)
		for _, otherPlayer in ipairs(game.Players:GetPlayers()) do
			if otherPlayer ~= player and otherPlayer.Character then
				if espEnabled then
					addESPToCharacter(otherPlayer.Character, otherPlayer)
				else
					removeESPFromCharacter(otherPlayer.Character)
				end
			end
		end
	end
end)

-- New player joins
game.Players.PlayerAdded:Connect(function(newPlayer)
	newPlayer.CharacterAdded:Connect(function(char)
		repeat task.wait() until char:FindFirstChild("HumanoidRootPart")
		if espEnabled then
			addESPToCharacter(char, newPlayer)
		end
	end)
end)
